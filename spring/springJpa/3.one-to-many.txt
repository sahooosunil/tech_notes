## **Understanding @OneToMany and @ManyToOne in Spring Data JPA**  

### **Relationship Explanation**  
A **One-to-Many** relationship means that **one parent entity** is related to **multiple child entities**.  
A **Many-to-One** relationship is the inverse: **many child entities** are related to **one parent entity**.

ğŸ“Œ **Example Scenario:**  
- A **Department** has **multiple Employees** â†’ `@OneToMany`  
- Each **Employee** belongs to exactly **one Department** â†’ `@ManyToOne`  

---

## **1ï¸âƒ£ Define the Entities**  

### **Department Entity (Parent)**
```java
@Entity
public class Department {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;

    @OneToMany(mappedBy = "department", cascade = CascadeType.ALL, orphanRemoval = true)
    private List<Employee> employees = new ArrayList<>();

    // Getters and Setters
}
```
âœ… **`@OneToMany(mappedBy = "department")`** â†’ One department has multiple employees.  
âœ… **`cascade = CascadeType.ALL`** â†’ When a department is saved, its employees are also saved.  
âœ… **`orphanRemoval = true`** â†’ If an employee is removed from the list, it will be deleted from the database.  

---

### **Employee Entity (Child)**
```java
@Entity
public class Employee {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    private String position;

    @ManyToOne
    @JoinColumn(name = "department_id", nullable = false) // Foreign key column
    private Department department;

    // Getters and Setters
}
```
âœ… **`@ManyToOne`** â†’ Many employees belong to one department.  
âœ… **`@JoinColumn(name = "department_id")`** â†’ This sets up the foreign key in the `Employee` table.  
âœ… **`nullable = false`** â†’ Ensures an employee **must** have a department.  

---

## **2ï¸âƒ£ Define the Repositories**
### **Department Repository**
```java
@Repository
public interface DepartmentRepository extends JpaRepository<Department, Long> {
}
```
### **Employee Repository**
```java
@Repository
public interface EmployeeRepository extends JpaRepository<Employee, Long> {
}
```

---

## **3ï¸âƒ£ Saving Data (Service Layer)**
```java
@Service
public class CompanyService {
    @Autowired
    private DepartmentRepository departmentRepository;

    public void createDepartmentWithEmployees() {
        Department department = new Department();
        department.setName("IT Department");

        Employee emp1 = new Employee();
        emp1.setName("John Doe");
        emp1.setPosition("Software Engineer");
        emp1.setDepartment(department);

        Employee emp2 = new Employee();
        emp2.setName("Jane Smith");
        emp2.setPosition("System Analyst");
        emp2.setDepartment(department);

        department.getEmployees().add(emp1);
        department.getEmployees().add(emp2);

        departmentRepository.save(department); // Saves both department and employees
    }
}
```
ğŸ”¹ Since we used **`CascadeType.ALL`**, saving `Department` **also saves** `Employees`.  

---

## **4ï¸âƒ£ Fetching Data**
```java
public void getDepartment(Long deptId) {
    Optional<Department> department = departmentRepository.findById(deptId);
    department.ifPresent(dept -> {
        System.out.println("Department: " + dept.getName());
        dept.getEmployees().forEach(emp -> System.out.println("Employee: " + emp.getName()));
    });
}
```

---

## **5ï¸âƒ£ Generated Tables (SQL Schema)**
ğŸ”¹ **Department Table**
| id | name         |
|----|-------------|
| 1  | IT Department |

ğŸ”¹ **Employee Table**
| id | name       | position           | department_id |
|----|-----------|--------------------|--------------|
| 1  | John Doe  | Software Engineer  | 1            |
| 2  | Jane Smith | System Analyst    | 1            |

---

## **ğŸ”¥ Key Takeaways**
âœ… **`@OneToMany`** on the **parent** (`Department`).  
âœ… **`@ManyToOne`** on the **child** (`Employee`).  
âœ… **`cascade = CascadeType.ALL`** ensures that saving/deleting a department also affects its employees.  
âœ… **`orphanRemoval = true`** ensures that removing an employee from the list deletes it from the database.  

Would you like a **Spring Boot REST API** for this? ğŸš€